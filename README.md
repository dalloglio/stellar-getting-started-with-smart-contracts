# Getting started with Stellar Smart Contracts

Smart contracts are self-executing programs with the terms of an agreement written directly into the code. They automatically enforce and execute the terms of the contract when predefined conditions are met. Developers must define the rules and logic of the contract while also ensuring security. Once written and tested, smart contracts are deployed to the blockchain, where they become immutable and publicly accessible.

This project walk through how to get set up to write smart contracts on Stellar, plus an introduction to testing, storing data, and deploying your contracts. It also provides an array of example contracts for use.

Tutorial from https://developers.stellar.org/docs/build/smart-contracts/getting-started

Below you will see `--source bob` where `bob` is the public identity key generated by the [Docker image used](https://hub.docker.com/r/dalloglio/rust-with-stellar-cli).

## Run the container

```bash
docker compose up -d
```

## Access the container to execute the following commands

```bash
docker compose exec app bash
```

## Set up a test identity for the bob user

```bash
stellar keys generate --global bob --network local
```

To view bob's public key, use:

```bash
stellar keys address bob
```

To view bob's secret key, use:

```bash
stellar keys show bob
```

## Run the tests

```bash
cargo test
```

## Build the contract

```bash
stellar contract build
```

## Deploy the contract "hello-world" to Testnet

```bash
stellar contract deploy \
    --wasm target/wasm32-unknown-unknown/release/hello_world.wasm \
    --source bob \
    --network local
```

This returns the contract's id, starting with a `C`. In this example, we're going to use `CBT3DECFK3LIVI7L4RBYVTSVKTRMDJCZ25OXMA5NSOERO7SZY2JJ4Y3C`, so replace it with your actual contract id.

## Interact with the deployed "hello-world" contract

```bash
stellar contract invoke \
    --id CBT3DECFK3LIVI7L4RBYVTSVKTRMDJCZ25OXMA5NSOERO7SZY2JJ4Y3C \
    --source bob \
    --network local \
    -- \
    hello \
    --to RPC
```

The following output should appear.

```bash
["Hello","RPC"]
```

## Add the "increment" contract

```bash
stellar contract init ./ --with-example increment
```

## Run the tests again

```bash
cargo test
```

## Build the contracts

```bash
stellar contract build
```

## Deploy the "increment" contract (two-step deployment)

Step 1:

```bash
stellar contract install \
    --wasm target/wasm32-unknown-unknown/release/increment.wasm \
    --source bob \
    --network local
```

This returns the hash of the Wasm bytes, like `83310b1b69abb88561a80cf5b62414d054246ec5c92c3f8539ec08b16a8a6275`. Now you can use `--wasm-hash` with deploy rather than `--wasm`.

Step 2:

```bash
stellar contract deploy \
    --wasm-hash 83310b1b69abb88561a80cf5b62414d054246ec5c92c3f8539ec08b16a8a6275 \
    --source bob \
    --network local
```

This returns the contract's id, starting with a `C`. In this example, we're going to use `CAVJPGAT7AUPKGAR7CGYGEA6WFSTTPLNJPFB26V4EFK5USLNWVGR3MVG`, so replace it with your actual contract id.

## Interact with the deployed "increment" contract

```bash
stellar contract invoke \
    --id CAVJPGAT7AUPKGAR7CGYGEA6WFSTTPLNJPFB26V4EFK5USLNWVGR3MVG \
    --source bob \
    --network local \
    -- \
    increment
```

Run it a few more times to watch the count change.
